var he=Object.defineProperty;var be=(h,F,V)=>F in h?he(h,F,{enumerable:!0,configurable:!0,writable:!0,value:V}):h[F]=V;var ee=(h,F,V)=>(be(h,typeof F!="symbol"?F+"":F,V),V);import{f as re,c as w,g as qe}from"./tslib.es6-cf84f67d.js";import{e as W}from"./equipment.api-0a141195.js";const Y=(()=>{function h(N,g,k="UNKNOWN",D={}){const P=JSON.parse(JSON.stringify(g)),f={};for(const d in N.required)o(d,N.required[d]);return f;function o(d,J){const _=W.recipe(d,k),A=W.fragmentID(d);if(P[d]&&!D[W.rarity(d)]){if(f[d]=J-P[d],f[d]<=0){f[d]=J,P[d]-=J;return}f[d]=P[d],J-=P[d],P[d]=0}if(!D[W.rarity(d)]&&_.required_pieces>0&&(f[A]=_.required_pieces*J+(f[A]||0)),!D[W.rarity(d)])for(const E of _.required_items)o(E,J)}}function F(N,g,k="UNKNOWN",D={},P=!1){const f=`api.project#check: (${k} | ${N.date})`;P||console.time(f);const o=h(N,g,k,D),d=JSON.parse(JSON.stringify(o));for(const J in o)o[J]-=g[J]||0,o[J]<=0&&delete o[J];return P||console.timeEnd(f),{success:Object.keys(o).length<=0,remaining:o,recipe:d}}function V(N,g,k="UNKNOWN",D={}){const P=`api.project#consume: (${k} | ${N.date})`;console.time(P);const f=JSON.parse(JSON.stringify(g)),o=h(N,g,k,D);for(const d in o)f[d]-=o[d],(f[d]<=0||isNaN(f[d]))&&delete f[d];return console.timeEnd(P),f}function v(N){const g={};for(const k of N)for(const D in k.required)g[D]=(g[D]||0)+k.required[D];return g}function Q(N,g,k="UNKNOWN",D={}){const P=F(N,g,k,D),f={progress:-1,items:{current:0,max:0},fragments:{current:0,max:0},check:P};for(const o in P.recipe)f.items.max++,f.fragments.max+=P.recipe[o];if(P.success)return f.progress=100,f.items.current=f.items.max,f.fragments.current=f.fragments.max,f;for(const o in P.remaining)f.items.current++,f.fragments.current+=P.remaining[o];return f.items.current=f.items.max-f.items.current,f.fragments.current=f.fragments.max-f.fragments.current,f.progress=parseFloat((f.fragments.current/f.fragments.max*100).toFixed(2)),f}function T(N,g,k,D={},P=!0){var d,J;let f;P?f=Z.character.get():f={};let o=[];for(const _ of N){let A=function(){let H={},t;for(let u=E;u<=g;u++)for(let r=0;r<6;r++){if(t=re.equipment(_,u)[r]||w.placeholder_id,t===w.placeholder_id){R[r]=!1;continue}if(E===g)!a[r]&&R[r]&&l();else if(u===g&&R[r])l();else if(u<g){if(u===E&&a[r])continue;l()}}return H;function l(){H[t]=H[t]?H[t]+1:1}};const E=((d=f[_])==null?void 0:d.rank)||1;if(E>g)continue;const a=((J=f[_])==null?void 0:J.equipment)||[!1,!1,!1,!1,!1,!1];let R=[!1,!1,!1,!1,!1,!1];if(E===g){let H=0;for(let t=0;t<6;t++){if(a[t]){R[t]=!0;continue}k[t]&&(R[t]=!0,H++)}if(H<=0)continue}else{if(E+1===g&&a.filter(Boolean).length===6&&k.filter(Boolean).length===0)continue;R=k}const B={type:"character",date:Date.now()+N.indexOf(_),priority:!1,details:{avatar_id:_,formal_name:`${re.name(_,Z.region.get())} (${_})`,name:"",start:{rank:E,equipment:a},end:{rank:g,equipment:R},memory_piece:0,pure_memory_piece:0,ignored_rarities:D},required:A()};Object.keys(B.required).length<=0||o.push(B)}if(o.length>=2){const _={type:"character",date:Date.now()+o.length,priority:!1,details:{avatar_id:w.placeholder_id,formal_name:"All Projects",name:"",start:{rank:1,equipment:[!1,!1,!1,!1,!1,!1]},end:{rank:1,equipment:[!1,!1,!1,!1,!1,!1]},memory_piece:0,pure_memory_piece:0,ignored_rarities:D},required:{}};for(const A of o)for(const E in A.required)_.required[E]=(_.required[E]||0)+A.required[E];o.unshift(_)}return o}function z(N=0){const g={};if(N>0)for(let o=0;o<N&&Object.keys(g).length<N;o++)g[W.getRandomItem()]=10;const k=re.getRandomCharacter(),D=Math.floor(Math.random()*re.getMaxRank())+1,P=Math.floor(Math.random()*D)+1;return{type:"character",date:Date.now(),priority:!1,details:{avatar_id:k.id,formal_name:`${k.name.JP} (${k.id})`,name:k.name.JP,start:{rank:P,equipment:f()},end:{rank:D,equipment:f()},memory_piece:0,pure_memory_piece:0,ignored_rarities:{1:Math.random()<.5,2:Math.random()<.5,3:Math.random()<.5,4:Math.random()<.5,5:Math.random()<.5,6:Math.random()<.5,7:Math.random()<.5,8:Math.random()<.5}},required:g};function f(){return[Math.random()<.5,Math.random()<.5,Math.random()<.5,Math.random()<.5,Math.random()<.5,Math.random()<.5]}}function G(N=0){const g={};if(N>0)for(let k=0;k<N&&Object.keys(g).length<N;k++)g[W.getRandomItem()]=10;return{type:"item",date:Date.now(),priority:!1,details:{name:"Untitled Project",ignored_rarities:{1:Math.random()<.5,2:Math.random()<.5,3:Math.random()<.5,4:Math.random()<.5,5:Math.random()<.5,6:Math.random()<.5,7:Math.random()<.5,8:Math.random()<.5}},required:g}}return{build:h,check:F,consume:V,compile:v,progress:Q,bulkCreateProjects:T,getTestCharacterProject:z,getTestItemProject:G}})();class ne{}ee(ne,"max_chapter",-1);const se=(()=>{const h=qe.quest;function F(t){return h[t]}function V(t,l){var u,r,n,i,m;if(h[t])return l?((n=(r=h[t])==null?void 0:r.name)==null?void 0:n[l])||((m=(i=h[t])==null?void 0:i.name)==null?void 0:m.JP):(u=h[t])==null?void 0:u.name}function v(t,l){var u,r,n,i,m;if(h[t])return l?((n=(r=h[t])==null?void 0:r.stamina)==null?void 0:n[l])||((m=(i=h[t])==null?void 0:i.stamina)==null?void 0:m.JP):(u=h[t])==null?void 0:u.stamina}function Q(t,l){var n,i;const u=(n=h[t])==null?void 0:n.drop_table[l],r=u?u.memory_piece:(i=h[t])==null?void 0:i.drop_table.JP.memory_piece;return r&&r.item!==w.placeholder_id?r:void 0}function T(t,l){var n,i;const u=(n=h[t])==null?void 0:n.drop_table[l];return(u?u.drops:(i=h[t])==null?void 0:i.drop_table.JP.drops)||[]}function z(t,l){var n,i;const u=(n=h[t])==null?void 0:n.drop_table[l];return(u?u.subdrops:(i=h[t])==null?void 0:i.drop_table.JP.subdrops)||[]}function G(t,l){var n,i;const u=(n=h[t])==null?void 0:n.drop_table[l];return(u?u.subdrops_2:(i=h[t])==null?void 0:i.drop_table.JP.subdrops_2)||[]}function N(t){return t!==""&&!t.includes(w.difficulty.hard)&&!t.includes(w.difficulty.event)}function g(t){return t.includes(w.difficulty.hard)&&!t.includes(w.difficulty.very_hard)}function k(t){return t.includes(w.difficulty.very_hard)}function D(t){return t.includes(w.difficulty.event)}function P(t){return parseInt(t.split("-")[0])}function f(t){return parseInt(t.split("-")[1])}function o(){if(ne.max_chapter===-1){let t=-1;for(const l in h){const u=P(l);t=Math.max(t,u)}ne.max_chapter=t}return ne.max_chapter}function d(t){return h[t]!==void 0}function J({all_projects:t,compiled_items:l,inventory:u,settings:r={},use_inventory:n=!1,language:i="UNKNOWN"}){const m=`api.quest#build: (${i} | ${Date.now().toLocaleString()})`;console.time(m);let C,b;if(n){const I=Y.check({date:"quest-build",required:l},u,i,r.ignored_rarities);C=I.remaining,b=I.recipe}else C=b=Y.build({date:"quest-build",required:l},{},i,r.ignored_rarities);if(Object.keys(C).length<=0)return console.log("can't make quest list with no required items"),console.timeEnd(m),{required:C,required_clean:b,quest_scores:[],priority_items:[],priority_amount:{}};let y=new Set,O={};for(const I of t)if(I.priority)for(const p in I.required)W.exists(p)&&(y.add(p),O[p]=(O[p]||0)+I.required[p]);const K=Array.from(y).reduce((I,p)=>(I[p]=O[p],I),{});O=Y.build({date:"quest-build",required:K},{},i,{});const j=Object.keys(O),S=E({required:C,priority_items:j,priority_levels:{},settings:r,language:i});return console.timeEnd(m),{required:C,required_clean:b,quest_scores:S,priority_items:j,priority_amount:O}}function _({session_projects:t,inventory:l,settings:u,use_inventory:r=!1,language:n,silent:i=!1}){var $;l||(l=Z.inventory.get()),u||(u=Z.settings.quest.get()),n||(n=Z.region.get());const m=`api.quest#build2: (${n} | ${Date.now().toLocaleString()})`;i||console.time(m);const C=Object.keys(t).filter(c=>t[c].enabled).map(c=>t[c].project),b=Y.compile(C);let y,O;if(r){const c=Y.check({date:"quest-build-with-inventory",required:b},l,n,u.ignored_rarities,i);y=c.remaining,O=c.recipe}else y=O=Y.build({date:"quest-build-no-inventory",required:b},{},n,u.ignored_rarities);if(Object.keys(y).length<=0)return i||(console.log("can't make quest list with no required items"),console.timeEnd(m)),{required:y,required_clean:O,quest_scores:[],priority_items:[],priority_amount:{},projects:C};let K={},j=new Set,S={};for(const c in t){const U=t[c].project;if(U.priority)for(const s in U.required){if(!W.exists(s))continue;const te=(($=U.details)==null?void 0:$.priority_level)||2;K[s]=K[s]&&K[s]>te?K[s]:te,j.add(s),S[s]=(S[s]||0)+U.required[s]}}const I=Array.from(j).reduce((c,U)=>(c[U]=S[U],c),{}),p=A(I,K,n),X=Object.keys(p.priority_amount),M=E({required:y,priority_items:X,priority_levels:p.priority_levels,settings:u,language:n});return i||console.timeEnd(m),{required:y,required_clean:O,quest_scores:M,priority_items:X,priority_amount:p.priority_amount,projects:C}}function A(t,l,u="UNKNOWN"){const r={},n={};for(const m in t)i(m,t[m],l[m]);return{priority_amount:r,priority_levels:n};function i(m,C,b){const y=W.recipe(m,u),O=W.fragmentID(m);y.required_pieces>0&&(r[O]=y.required_pieces*C+(r[O]||0),n[O]=n[O]&&n[O]>b?n[O]:b);for(const K of y.required_items)i(K,C,b)}}function E({required:t,priority_items:l,priority_levels:u,settings:r={},language:n="UNKNOWN"}){var m,C,b;let i=[];for(const y in h){let O=function(S){if(!S||!t.hasOwnProperty(S.item))return 0;let I=S.drop_rate;return I*=l.includes(S.item)?u[S.item]:1,I+=t[S.item]/w.inventory.max.fragment*1e3,I};const K=P(y);if(r.chapter&&(K<r.chapter.min||K>r.chapter.max)||r.disabled_difficulty&&(r.disabled_difficulty.Normal&&N(y)||r.disabled_difficulty.Hard&&g(y)||r.disabled_difficulty["Very Hard"]&&k(y)||r.disabled_difficulty.Event&&D(y)))continue;if(r.item_filter&&r.item_filter.length>0){let S=!1;for(const I of r.item_filter)if(a(I,y,n)){S=!0;break}if(!S)continue}let j=0;j+=O(Q(y,n));for(const S of T(y,n))j+=O(S);for(const S of z(y,n))j+=O(S);for(const S of G(y,n))j+=O(S);if(N(y)&&((m=r==null?void 0:r.drop_buff)!=null&&m.Normal)&&(j*=r.drop_buff.Normal),g(y)&&((C=r==null?void 0:r.drop_buff)!=null&&C.Hard)&&(j*=r.drop_buff.Hard),k(y)&&((b=r==null?void 0:r.drop_buff)!=null&&b["Very Hard"])&&(j*=r.drop_buff["Very Hard"]),j>0){const S=v(y,n);typeof S=="number"&&(j/=S),i.push({id:y,score:+j.toFixed(2)})}}return i.sort((y,O)=>{const K={id:y.id,chapter:P(y.id),number:f(y.id),value:0},j={id:O.id,chapter:P(O.id),number:f(O.id),value:0};function S(M){k(M.id)&&(M.value+=2e3),(g(M.id)||D(M.id))&&(M.value+=1e3),M.value+=M.chapter*1e4+M.number*10}function I(M,$){return M-$}function p(M,$){return $-M}S(K),S(j);let X=r.sort&&r.sort.score?I(y.score,O.score):p(y.score,O.score);return X!==0?X:r.sort&&r.sort.list?p(K.value,j.value):I(K.value,j.value)}),i}function a(t,l,u){let r,n;if(W.exists(t)?(r=t,n=W.fragment(t)):(r=W.convertFragmentID(t),n=t),r===w.placeholder_id)return!1;const i=Q(l,u);if((i==null?void 0:i.item)===r)return!0;for(const m of T(l,u))if(m.item===r||m.item===n)return!0;for(const m of z(l,u))if(m.item===r||m.item===n)return!0;for(const m of G(l,u))if(m.item===r||m.item===n)return!0;return!1}function R(t){console.time("quest.estimate");const u=Y.build({required:t},{});let r=0;for(const n in h){let i=function(m){const C=Q(n,"JP");if(C&&u.hasOwnProperty(C.item))return++m;for(const b of T(n,"JP"))if(u.hasOwnProperty(b.item))return++m;for(const b of z(n,"JP"))if(u.hasOwnProperty(b.item))return++m;for(const b of G(n,"JP"))if(u.hasOwnProperty(b.item))return++m;return m};if(r>=100)break;r=i(r)}return console.timeEnd("quest.estimate"),r}function B(t,l={normal_drop:1,hard_drop:1,very_hard_drop:1,use_inventory:!0,precise:!1},u=void 0){const r=`api.quest#questSimulator: (${Date.now().toLocaleString()};precise:${l.precise||!1})`;console.time(r);let n;l.use_inventory?n=JSON.parse(JSON.stringify(Z.inventory.get())):n={};let i;u?i=JSON.parse(JSON.stringify(u)):i=O();let m=[],C=0,b={};const y=JSON.parse(JSON.stringify(i.required));for(;i.quest_scores.length>0;){const j=K(i.quest_scores[0].id,Z.region.get());(l.precise||j)&&(i=O())}return console.timeEnd(r),{stamina:C,quests:m,total_drops:b,required:y};function O(){return _({session_projects:t,inventory:n,use_inventory:!0,silent:!0,settings:Z.settings.quest.get()})}function K(j,S){let I=!1;const p=D(j)?1:k(j)?l.very_hard_drop||1:g(j)?l.hard_drop||1:N(j)&&l.normal_drop||1,X=v(j,S),M={};C+=X;const $=Q(j,S);$&&Math.random()*100<=$.drop_rate&&(n[$.item]=n[$.item]?n[$.item]+p:p,b[$.item]=b[$.item]?b[$.item]+p:p,M[$.item]=M[$.item]?M[$.item]+p:p,i.required_clean[$.item]&&i.required[$.item]>0&&n[$.item]>=i.required_clean[$.item]&&(I=!0));for(const s of T(j,S)){if(s.item===w.placeholder_id)continue;Math.random()*100<=s.drop_rate&&(n[s.item]=n[s.item]?n[s.item]+p:p,b[s.item]=b[s.item]?b[s.item]+p:p,M[s.item]=M[s.item]?M[s.item]+p:p,i.required_clean[s.item]&&i.required[s.item]>0&&n[s.item]>=i.required_clean[s.item]&&(I=!0))}let c=Math.random()*100,U=0;for(const s of z(j,S))if(s.item!==w.placeholder_id&&(U+=s.drop_rate,c<=U)){n[s.item]=n[s.item]?n[s.item]+p:p,b[s.item]=b[s.item]?b[s.item]+p:p,M[s.item]=M[s.item]?M[s.item]+p:p,i.required_clean[s.item]&&i.required[s.item]>0&&n[s.item]>=i.required_clean[s.item]&&(I=!0);break}c=Math.random()*100,U=0;for(const s of G(j,S))if(s.item!==w.placeholder_id&&(U+=s.drop_rate,c<=U)){n[s.item]=n[s.item]?n[s.item]+p:p,b[s.item]=b[s.item]?b[s.item]+p:p,M[s.item]=M[s.item]?M[s.item]+p:p,i.required_clean[s.item]&&i.required[s.item]>0&&n[s.item]>=i.required_clean[s.item]&&(I=!0);break}return m.push({id:j,stamina:X,total_stamina:C,drops:M}),I}}function H(t,l){return d(t)&&F(t).name[l]!==void 0}return{data:h,get:F,name:V,stamina:v,memoryPiece:Q,drops:T,subdrops:z,subdrops2:G,isNormal:N,isHard:g,isVeryHard:k,isEvent:D,getChapter:P,getNumber:f,getMaxChapter:o,exists:d,build:J,build2:_,search:E,checkForItem:a,estimate:R,existsInRegion:H,questSimulator:B}})();class e{}ee(e,"is_init"),ee(e,"user_state"),ee(e,"force_no_localstorage"),ee(e,"projects",{}),ee(e,"create_project_ignored_rarities");const Z=(()=>{function h(){if(!T()){if(Q()){localStorage.getItem(w.legacy_localstorage_key)?(console.log("importing old settings"),F()):localStorage.getItem(w.localstorage_key)===null?(console.log("init new user"),e.user_state=JSON.parse(JSON.stringify(w.default_user_state)),v()):(console.log("loading user from localstorage"),e.user_state=JSON.parse(localStorage.getItem(w.localstorage_key))),e.is_init=!0;return}console.warn("localstorage is not supported on this browser, using basic state"),e.user_state=JSON.parse(JSON.stringify(w.default_user_state)),e.is_init=!0}}function F(){var J;const o=JSON.parse(localStorage.getItem(w.legacy_localstorage_key));e.user_state=JSON.parse(JSON.stringify(w.default_user_state));for(const _ in o.character){const A=o.character[_];e.user_state.character[_]={...A,id:_}}e.user_state.inventory=o.inventory;for(const _ of o.projects){let A={};_.details.ignored_rarity&&(A=JSON.parse(JSON.stringify(_.details.ignored_rarity)),delete _.details.ignored_rarity),e.user_state.projects[_.date]={type:_.type,date:parseInt(_.date),priority:_.priority,details:{..._.details,ignored_rarities:A,...!_.details.memory_piece&&{memory_piece:0},...!_.details.pure_memory_piece&&{pure_memory_piece:0}},required:_.required}}e.user_state.settings.region=o.settings.region;let d={};o.settings.quest.ignored_rarity&&(d=JSON.parse(JSON.stringify(o.settings.quest.ignored_rarity)),delete o.settings.quest.ignored_rarity),e.user_state.settings.quest=o.settings.quest,e.user_state.settings.quest.ignored_rarities=d,(J=e.user_state.settings.quest.chapter)!=null&&J.max&&se.getMaxChapter()<o.settings.quest.chapter.max&&(e.user_state.settings.quest.chapter.max=se.getMaxChapter(),e.user_state.settings.quest.chapter.min&&e.user_state.settings.quest.chapter.min>e.user_state.settings.quest.chapter.max&&(e.user_state.settings.quest.chapter.min=e.user_state.settings.quest.chapter.max)),v(),localStorage.removeItem(w.legacy_localstorage_key)}function V(){return e.user_state||h(),e.user_state}function v(){if(!Q()){console.log("local storage not supported, cant save");return}localStorage.setItem(w.localstorage_key,JSON.stringify(e.user_state)),console.log("saved user state",e.user_state)}function Q(){return typeof Storage<"u"&&!e.force_no_localstorage}function T(){return e.is_init}function z(){return e.projects}function G(){e.force_no_localstorage=!e.force_no_localstorage}const N=(()=>{function o(a){e.user_state.inventory=a,v()}function d(a,R){R<=0?delete e.user_state.inventory[a]:e.user_state.inventory[a]=R>=w.inventory.max.fragment?w.inventory.max.fragment:R,v()}function J(){return e.user_state.inventory}function _(a){return e.user_state.inventory[a]||0}function A(a,R){d(a,_(a)+R)}function E(a){delete e.user_state.inventory[a],v()}return{set:o,setAmount:d,get:J,getAmount:_,remove:E,addAmount:A}})(),g=(()=>{function o(a){e.user_state.character=a,v()}function d(){return e.user_state.character}function J(a,R,B){e.user_state.character={...e.user_state.character,[a]:e.user_state.character[a]||{id:a},[a]:{...e.user_state.character[a],rank:R,equipment:B}},v()}function _(a){return e.user_state.character[a]}function A(a){return e.user_state.character[a]!==void 0}function E(a){A(a)&&(delete e.user_state.character[a],v())}return{set:o,get:d,setCharacter:J,getCharacter:_,exists:A,remove:E}})(),k=(()=>{function o(c,U){e.user_state.settings={...e.user_state.settings,[c]:U},v()}function d(c){e.user_state.settings=c,v()}function J(){return e.user_state.settings}function _(){return e.user_state.settings.hide_content||!1}function A(c){o("hide_content",c)}function E(){return e.user_state.settings.compact_project_cards||!1}function a(c){o("compact_project_cards",c)}function R(){return e.user_state.settings.auto_enable_projects||!1}function B(c){o("auto_enable_projects",c)}function H(){return e.user_state.settings.keep_enabled_projects!==void 0&&e.user_state.settings.keep_enabled_projects.enabled}function t(c){if(!e.user_state.settings.keep_enabled_projects||c){let U={};for(const s in e.projects)e.projects[s].enabled&&(U[`${e.projects[s].project.date}`]=!0);o("keep_enabled_projects",{enabled:!0,projects:U});return}delete e.user_state.settings.keep_enabled_projects,v()}function l(c){e.user_state.settings.keep_enabled_projects&&(e.user_state.settings.keep_enabled_projects.projects=c,v())}function u(){return e.user_state.settings.keep_enabled_projects?e.user_state.settings.keep_enabled_projects.projects:{}}function r(){return e.user_state.settings.inventory_alternative_mode||!1}function n(c){o("inventory_alternative_mode",c)}function i(){return e.user_state.settings.simulator_stamina_overlay||!1}function m(c){o("simulator_stamina_overlay",c)}function C(){return e.user_state.settings.simulator_dont_use_inventory||!1}function b(c){o("simulator_dont_use_inventory",c)}function y(){return e.user_state.settings.project_sort||void 0}function O(){return e.user_state.settings.session_ignored_rarities||{}}function K(){o("session_ignored_rarities",e.create_project_ignored_rarities)}function j(){return e.user_state.settings.display_all_project||!1}function S(c){o("display_all_project",c)}function I(){return e.user_state.settings.all_project_first||!1}function p(c){o("all_project_first",c)}function X(){return e.user_state.settings.all_project_ignored_rarities||{}}function M(c){o("all_project_ignored_rarities",c)}const $=(()=>{function c(){return e.user_state.settings.quest||(e.user_state.settings.quest={}),e.user_state.settings.quest}function U(){return c()}function s(q,x){const L=c();L.chapter={min:q,max:x,auto_max:x===se.getMaxChapter()},v()}function te(){return c().chapter}function oe(q){const x=c();if(x.disabled_difficulty||(x.disabled_difficulty={}),x.disabled_difficulty[q]){delete x.disabled_difficulty[q],v();return}x.disabled_difficulty[q]=!0,v()}function ie(){return c().disabled_difficulty}function ae(q){var x;return((x=ie())==null?void 0:x[q])||!1}function ce(q){const x=c();x.item_filter=q,v()}function ue(){return c().item_filter||[]}function fe(q,x){const L=c();if(L.drop_buff||(L.drop_buff={}),x===1){delete L.drop_buff[q],v();return}L.drop_buff[q]=x,v()}function le(q){var L;return((L=c().drop_buff)==null?void 0:L[q])||1}function de(){const q=c();if(q.sort||(q.sort={}),q.sort.list){delete q.sort.list,v();return}q.sort.list=!0,v()}function _e(){var x;return((x=c().sort)==null?void 0:x.list)||!1}function me(){const q=c();if(q.sort||(q.sort={}),q.sort.score){delete q.sort.score,v();return}q.sort.score=!0,v()}function pe(){var x;return((x=c().sort)==null?void 0:x.score)||!1}function ge(q){const x=c();if(x.ignored_rarities||(x.ignored_rarities={}),x.ignored_rarities[q]){delete x.ignored_rarities[q],v();return}x.ignored_rarities[q]=!0,v()}function ye(q){var L;return((L=c().ignored_rarities)==null?void 0:L[q])||!1}return{get:U,setChapterRange:s,getChapterRange:te,disableDifficulty:oe,getDisabledDifficulties:ie,isDisabledDifficulty:ae,setItemFilter:ce,getItemFilter:ue,setDropBuff:fe,getDropBuff:le,toggleListSort:de,getListSort:_e,toggleScoreSort:me,getScoreSort:pe,ignoreRarity:ge,isRarityIgnored:ye}})();return{set:o,setAll:d,get:J,hideContent:_,setHideContent:A,isCompactProjectCards:E,setCompactProjectCards:a,isAutoEnableProjects:R,setAutoEnableProjects:B,isInventoryAlternativeMode:r,setInventoryAlternativeMode:n,isSimulatorStaminaOverlay:i,setSimulatorStaminaOverlay:m,isSimulatorDontUseInventory:C,setSimulatorDontUseInventory:b,getProjectSortOptions:y,getSavedSessionIgnoredRarities:O,setSavedSessionIgnoredRarities:K,isDisplayAllProject:j,setDisplayAllProject:S,isAllProjectFirst:I,setAllProjectFirst:p,getAllProjectIgnoredRarities:X,setAllProjectIgnoredRarities:M,isKeepEnabledProjects:H,setKeepEnabledProjectsEnabledState:t,setKeepEnabledProjectsEnabledProjects:l,getKeepEnabledProjectsEnabledProjects:u,quest:$}})(),D=(()=>{function o(a){e.user_state.projects=a,v()}function d(){return e.user_state.projects}function J(a){e.user_state.projects[a.date||Date.now()]=a,v()}function _(a,R){e.user_state.projects[a]&&(e.user_state.projects[a]=R,v())}function A(a){delete e.user_state.projects[a],v()}function E(a,R={}){if(!e.user_state.projects[a.date])return;let B=R.consume?Y.consume(a,N.get(),k.get().region,a.details.ignored_rarities):N.get();if(R.save&&a.type==="character"){const H=a.details.avatar_id,t=g.get();g.set({...t,[H]:{id:H,rank:a.details.end.rank,equipment:a.details.end.equipment}}),N.set(B),A(a.date);return}N.set(B),A(a.date)}return{set:o,get:d,add:J,replace:_,delete:A,complete:E}})(),P=(()=>{function o(J){e.user_state.settings.region=J,v()}function d(){return e.user_state.settings.region||"UNKNOWN"}return{set:o,get:d}})();function f(){return e.create_project_ignored_rarities||(e.create_project_ignored_rarities=k.getSavedSessionIgnoredRarities()),e.create_project_ignored_rarities}return{init:h,get:V,save:v,isInit:T,_toggle_localstorage:G,getSessionProjects:z,getSessionIgnoredRarities:f,inventory:N,character:g,settings:k,projects:D,region:P}})();export{Y as p,se as q,Z as u};
